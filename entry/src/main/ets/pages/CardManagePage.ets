import { router } from '@kit.ArkUI';

interface AccessCard {
  cardId: string;
  owner: string;
}

// ã€å…³é”®ä¿®å¤ã€‘å®šä¹‰æ¥å£ï¼Œä¸èƒ½ä½¿ç”¨å­—é¢é‡ç±»å‹
interface SavedDevice {
  deviceId: string;
  deviceName: string;
}

@Entry
@Component
struct CardManagePage {
  // ã€å…³é”®ä¿®å¤ã€‘ä½¿ç”¨æ¥å£ç±»å‹
  @StorageLink('HistoryDevices') historyDevices: SavedDevice[] = [];

  build() {
    Column() {
      // 1. æ ‡é¢˜æ 
      Row() {
        Button("< è¿”å›")
          .type(ButtonType.Normal)
          .backgroundColor(Color.Transparent)
          .fontColor('#333333')
          .onClick(() => {
            try { router.back(); } catch(e) {}
          })

        Text("é—¨ç¦å¡ç®¡ç†")
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .layoutWeight(1)
          .textAlign(TextAlign.Center)
          .margin({ right: 40 })
      }
      .width('100%')
      .padding({ top: 10, bottom: 10 })
      .backgroundColor(Color.White)

      // 2. è®¾å¤‡å¡ç‰‡åˆ—è¡¨
      List() {
        // ã€å…³é”®ä¿®å¤ã€‘ForEach ç±»å‹å£°æ˜ä½¿ç”¨ SavedDevice
        ForEach(this.historyDevices, (device: SavedDevice) => {
          ListItem() {
            Column() {
              // è®¾å¤‡å¤´
              Row() {
                Text(device.deviceName || "æœªçŸ¥è®¾å¤‡")
                  .fontSize(16)
                  .fontWeight(FontWeight.Bold)
                Blank()
                Text(device.deviceId)
                  .fontSize(12)
                  .fontColor('#999999')
              }
              .width('100%')
              .padding({ bottom: 10 })
              .border({ width: { bottom: 1 }, color: '#F0F0F0' })

              // å¡ç‰‡åˆ—è¡¨ (æ¨¡æ‹Ÿæ•°æ®)
              Column() {
                this.CardRow("UID: 93 4F 22 F8", "ç®¡ç†å‘˜")
                this.CardRow("UID: XX XX XX XX", "é¢„ç•™å¡ä½")
              }
              .width('100%')
              .padding({ top: 10 })
            }
            .width('100%')
            .backgroundColor(Color.White)
            .borderRadius(12)
            .padding(15)
            .margin({ bottom: 15 })
          }
        })
      }
      .width('100%')
      .layoutWeight(1)
      .padding(15)
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F2F3F5')
  }

  @Builder
  CardRow(cardId: string, remark: string) {
    Row() {
      // æš‚æ—¶ç”¨ Text å ä½ï¼Œé¿å…å›¾ç‰‡èµ„æºç¼ºå¤±æŠ¥é”™
      Text('ğŸ’³')
        .fontSize(20)
        .margin({ right: 10 })

      Column() {
        Text(cardId).fontSize(14)
        Text(remark).fontSize(12).fontColor('#999999')
      }
      .alignItems(HorizontalAlign.Start)

      Blank()

      Text("é»˜è®¤")
        .fontSize(12)
        .fontColor('#4CAF50')
        .backgroundColor('#E8F5E9')
        .padding({ left: 6, right: 6, top: 2, bottom: 2 })
        .borderRadius(4)
    }
    .width('100%')
    .margin({ bottom: 10 })
  }
}